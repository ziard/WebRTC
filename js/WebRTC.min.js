(function(t){"use strict";function e(t,e){var i;for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function i(t,e){var i,o;for(i=0;i<t.length;i++)o=t[i],e(o)}function o(t,i){this.element=document.querySelector(t),this.options=e({},this.options),e(this.options,i),this._init()}const n={QVGA:{width:{exact:320},height:{exact:240}},VGA:{width:{exact:640},height:{exact:480}},HD:{width:{exact:1280},height:{exact:720}},FullHD:{width:{exact:1920},height:{exact:1080}},fourK:{width:{exact:4096},height:{exact:2160}},eightK:{width:{exact:7680},height:{exact:4320}}},r='<video id="video" autoplay playsinline></video>',a=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,s=function(t){console.error("navigator.MediaDevices.getUserMedia error: ",t.message,t.name)},c=function(e){const i=document.querySelector("video");t.stream=e,navigator.mediaDevices?i.srcObject=e:t.webkitURL?i.src=t.webkitURL.createObjectURL(e):void 0!==i.mozSrcObject?i.mozSrcObject=e:i.src=e};o.prototype.options={resolution:null,fixWidth:null,front:!1,audio:!1},o.prototype._init=function(){this.element.innerHTML=r,this.options.fixWidth&&(this.element.style.width=this.options.fixWidth+"px",i(this.element.querySelectorAll("video"),function(t){t.style.setProperty("width","100%","important")}))},o.prototype.start=function(){const t=this,e={video:{facingMode:t.options.front?"user":"environment"},audio:t.options.audio};return t.options.resolution&&(e.video.width=n[t.options.resolution].width,e.video.height=n[t.options.resolution].height),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(navigator.mediaDevices.enumerateDevices().then(function(i){i=i.filter(function(t){return"videoinput"===t.kind});var o="";i.forEach(function(e){e.label.toLowerCase().search(t.options.front?"front":"back")>-1&&(o=e.deviceId)}),""!=o?(e.video.deviceId={exact:o},navigator.mediaDevices.getUserMedia(e).then(c)):navigator.mediaDevices.getUserMedia(e).then(c)}),!0):!!a&&(navigator.mediaDevices.getUserMedia(e).then(c).catch(s),!0)},o.prototype.stop=function(){t.stream&&t.stream.getTracks().forEach(function(t){t.stop()})},o.prototype.switch=function(){this.stop(),this.options.front=!this.options.front,this.start()},o.prototype.pause=function(){i(this.element.querySelectorAll("video"),function(t){t.pause()})},o.prototype.resume=function(){i(this.element.querySelectorAll("video"),function(t){t.play()})},o.prototype.capture=function(t,e){const o=document.querySelectorAll(t),n=this.element.querySelector("video");i(o,function(t){t.width=e.width?e.width:n.videoWidth,t.height=e.height?e.height:n.videoHeight,t.getContext("2d").drawImage(n,0,0,t.width,t.height)})},o.prototype.zoom=function(e){if(t.stream){const i=t.stream.getTracks()[0],o=i.getCapabilities();if(!("zoom"in o))return Promise.reject("Zoom is not supported by "+i.label);i.applyConstraints({advanced:[{zoom:e}]})}},t.WebRTC=o})(window);