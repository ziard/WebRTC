(function(t,e,i,o){"use strict";const n="WebRTC",a="plugin_"+n,s={resolution:null,fixWidth:null,front:!1,audio:!1},r={QVGA:{width:{exact:320},height:{exact:240}},VGA:{width:{exact:640},height:{exact:480}},HD:{width:{exact:1280},height:{exact:720}},FullHD:{width:{exact:1920},height:{exact:1080}},fourK:{width:{exact:4096},height:{exact:2160}},eightK:{width:{exact:7680},height:{exact:4320}}},c='<video id="video" autoplay playsinline></video>',d=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,h=function(t){console.error("navigator.MediaDevices.getUserMedia error: ",t.message,t.name)},u=function(t){const n=i.getElementById("video");e.stream=t,navigator.mediaDevices?n.srcObject=t:e.webkitURL?n.src=e.webkitURL.createObjectURL(t):n.mozSrcObject!==o?n.mozSrcObject=t:n.src=t};var f=function(e){this.options=t.extend({},s)};f.prototype={init:function(e){t.extend(this.options,e),this.element.html(c),e.fixWidth&&(this.element.css("width",e.fixWidth),this.element.find("video").each(function(){this.style.setProperty("width","100%","important")}))},start:function(){const t=this,e={video:{facingMode:t.options.front?"user":"environment"},audio:t.options.audio};return t.options.resolution&&(e.video.width=r[t.options.resolution].width,e.video.height=r[t.options.resolution].height),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(navigator.mediaDevices.enumerateDevices().then(function(i){i=i.filter(function(t){return"videoinput"===t.kind});var o="";i.forEach(function(e){e.label.toLowerCase().search(t.options.front?"front":"back")>-1&&(o=e.deviceId)}),""!=o?(e.video.deviceId={exact:o},navigator.mediaDevices.getUserMedia(e).then(u)):navigator.mediaDevices.getUserMedia(e).then(u)}),!0):!!d&&(navigator.mediaDevices.getUserMedia(e).then(u).catch(h),!0)},stop:function(){e.stream&&e.stream.getTracks().forEach(function(t){t.stop()})},switch:function(){this.stop(),this.options.front=!this.options.front,this.start()},pause:function(){this.element.find("video").get(0).pause()},resume:function(){this.element.find("video").get(0).play()},capture:function(t,e,i){const o=this.element.find("video").get(0);t.width=e||o.videoWidth,t.height=i||o.videoHeight,t.getContext("2d").drawImage(o,0,0,t.width,t.height)},zoom:function(t){if(e.stream){const i=e.stream.getTracks()[0],o=i.getCapabilities();if(!("zoom"in o))return Promise.reject("Zoom is not supported by "+i.label);i.applyConstraints({advanced:[{zoom:t}]})}},zoomBar:function(){}},t.fn[n]=function(e){var i,o;if(this.data(a)instanceof f||this.data(a,new f(this)),o=this.data(a),o.element=this,void 0===e||"object"==typeof e){if("function"==typeof o.init)return o.init(e),this}else{if("string"==typeof e&&!e.startsWith("_")&&"function"==typeof o[e])return i=Array.prototype.slice.call(arguments,1),o[e].apply(o,i);t.error("Method "+e+" does not exist on jQuery."+n)}}})(jQuery,window,document);